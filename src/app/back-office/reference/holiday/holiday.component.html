<app-ref-header></app-ref-header>

<div id="main-container" class="my-activity-theme">
    <h2>Gestion des jours fériés</h2>
    <div style="margin: 0 auto;width: 100%;">
        <table class="holiday-names">
            <tr>
                <th>
                    <a [href]="'back-office/reference/holiday?year='+prevyear">
                            <mat-icon>chevron_left</mat-icon>
                    </a>
                    {{ curryear }}
                    <a [href]="'/back-office/reference/holiday?year='+nextyear">
                        <mat-icon>chevron_right</mat-icon>
                    </a>
                </th>
                <ng-container *ngFor="let weekday of weekdays;let i = index">
                    <th [ngClass]="{'dayoff' : (i)%7 === 0 || (i)%7 === 6 }">{{ weekdayHeads [ (i)%7 ] }}</th>
                </ng-container>
                <ng-container *ngFor="let weekday of weekdays;let i = index">
                    <th [ngClass]="{'dayoff' : (i)%7 === 0 || (i)%7 === 6 }">{{ weekdayHeads [ (i)%7 ] }}</th>
                </ng-container>
                <ng-container *ngFor="let weekday of weekdays;let i = index">
                    <th [ngClass]="{'dayoff' : (i)%7 === 0 || (i)%7 === 6 }">{{ weekdayHeads [ (i)%7 ] }}</th>
                </ng-container>
                <ng-container *ngFor="let weekday of weekdays;let i = index">
                    <th [ngClass]="{'dayoff' : (i)%7 === 0 || (i)%7 === 6 }">{{ weekdayHeads [ (i)%7 ] }}</th>
                </ng-container>
                <ng-container *ngFor="let weekday of weekdays;let i = index">
                    <th [ngClass]="{'dayoff' : (i)%7 === 0 || (i)%7 === 6 }">{{ weekdayHeads [ (i)%7 ] }}</th>
                </ng-container>
                <ng-container *ngFor="let weekday of weekdays;let i = index">
                    <th [ngClass]="{'dayoff' : (i)%7 === 0 || (i)%7 === 6 }">{{ weekdayHeads [ (i)%7 ] }}</th>
                </ng-container>
            </tr>
            <ng-container *ngFor="let month of monthNames;let i = index">
                <tr>
                    <th>{{ month }}</th>
                    <ng-container *ngFor="let day of calendar[i];let j = index">
                        <td [ngClass]="{'dayoff' : (j)%7 === 0 || (j)%7 === 6, 'holiday': holilist[''+curryear+'-'+(i+1)+'-'+day] === 1 }">
                            <a (click)="setNewHoliday(day, i)">{{day}}</a>
                        </td>
                    </ng-container>
                </tr>
            </ng-container>
        </table>
    </div>
    <br />

    <div style="margin: 0 auto;width: 100%;">
        <table style="margin: 0 auto;" class="holiday-names">
            <tr>
                <th>Jour</th>
                <th>Nom</th>
                <th>Actions</th>
            </tr>
            <ng-container *ngFor="let hol of holidays;let i = index">
                <tr>
                    <td>{{ hol.month + '/' + hol.day + '/' + hol.year | date:'longDate':'':'fr-FR' }}</td>
                    <td>
                        <mat-autocomplete #auto="matAutocomplete" (optionSelected)="hasChanged(hol.id)" >
                            <mat-option *ngFor="let holiname of holinames" [value]="holiname" class="holname-opt">
                            {{holiname}}
                            </mat-option>
                        </mat-autocomplete>
                        <input type="text" id="i_{{hol.id}}" value="{{ hol.reason }}"
                            class="holname"
                            placeholder="Pick one"
                            aria-label="Number"
                            matInput
                            [matAutocomplete]="auto">
                        </td>
                            <!-- [formControl]="myControl" -->
                        <td class="actions">
                        <button mat-icon-button class="action" (click)="updateHoliday(hol.id)">
                            <mat-icon color="accent" class="action-icon">edit</mat-icon>
                        </button>
                        <button mat-icon-button class="action" (click)="unsetHoliday(hol.id)">
                            <mat-icon color="warn" class="action-icon">delete</mat-icon>
                        </button>
                    </td>
                </tr>
            </ng-container>
        </table>
    </div>
</div>
